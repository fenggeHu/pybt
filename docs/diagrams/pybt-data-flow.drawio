<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2026-02-20T09:43:34.000Z" agent="Codex" version="21.0.0">
  <diagram id="pybt-data-flow" name="PyBT Data Flow">
    <mxGraphModel dx="1420" dy="860" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <mxCell id="n_feed" value="Data Feed\n(local_csv/rest/ws/adata/sse)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="40" y="190" width="190" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="n_engine" value="BacktestEngine\nEventBus Dispatch" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="280" y="180" width="200" height="90" as="geometry"/>
        </mxCell>

        <mxCell id="n_strategy" value="Strategies\n(MA/Uptrend/Plugin)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="540" y="110" width="180" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="n_portfolio" value="Portfolio\n+ Risk Managers" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="540" y="210" width="180" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="n_execution" value="Execution Handler\n(immediate)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="540" y="310" width="180" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="n_reporter" value="Reporters\n(equity/detailed/tradelog)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="770" y="310" width="210" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="n_worker" value="apps/server/worker.py\nserialize events" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="770" y="190" width="210" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="n_manager" value="RunManager\nprocess + queue + event cache" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1030" y="190" width="220" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="n_api" value="FastAPI Server\n/runs /events /stream /summary" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1300" y="190" width="230" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="n_bridge" value="Signal Bridge\nNotificationIntentEvent" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="770" y="90" width="210" height="70" as="geometry"/>
        </mxCell>

        <mxCell id="n_outbox" value="NotificationOutbox\n(SQLite dedupe/retry)" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1030" y="80" width="220" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="n_bot" value="Telegram Bot\nsubscribe + send message" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1300" y="80" width="230" height="80" as="geometry"/>
        </mxCell>

        <mxCell id="n_user" value="Telegram User" style="ellipse;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1360" y="330" width="120" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="e1" value="MarketEvent" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_feed" target="n_engine">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e2" value="SignalEvent" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_engine" target="n_strategy">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e3" value="OrderEvent" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_strategy" target="n_portfolio">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e4" value="Reviewed Order" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_portfolio" target="n_execution">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e5" value="FillEvent" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_execution" target="n_reporter">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e6" value="events" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_engine" target="n_worker">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e7" value="IPC queue" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_worker" target="n_manager">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e8" value="REST/WS" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_manager" target="n_api">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e9" value="SignalEvent" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_worker" target="n_bridge">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e10" value="NotificationIntent" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_bridge" target="n_outbox">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e11" value="deliver" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_outbox" target="n_bot">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e12" value="message" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_bot" target="n_user">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e13" value="commands" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_user" target="n_bot">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e14" value="/runs /stream" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="n_bot" target="n_api">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
